# Linux_cpp_firsttry

[TOC]

https://subingwen.cn/linux/

## 第一章 Linux基础

### 一、初识Linux操作系统

https://subingwen.cn/linux/version-path/

#### 1. Linux介绍

**1.1 Linux诞生**

**Linux** 是 **UNIX 操作系统**的一个**克隆系统**, 但是Linux是**开源的**

Linux 和 GNU 一拍即合，就有了我们现在使用的操作系统，GNU 奠定了 Linux 用户基础和开发环境

**Linux主要特性：**

* Linux 是一个**基于文件**的操作系统

操作系统需要和硬件进行交互，对应 Linux 来说这些硬件都是文件，比如：操作系统会将 硬盘 , 鼠标 , 键盘 , 显示屏等抽象成一个设备文件来进行管理。

* 可以**同时登陆多个**用户，并且每个用户可以同时运行多个应用程序。
* 支持**多平台**（这里指的是基于不同 CPU 架构的平台）

**1.2 名词**

**GNU**：Gnu’s Not Unix

**GPL**：General Public License

**POSIX**：（Portable Operating System Interface for Computing Systems）

**1.3 Linux发行版**

**CentOS**：www.centos.org

CentOS 是一种对 RHEL（Red Hat Enterprise Linux）源代码再编译的产物，由于 Linux 是 开发源代码的操作系统，并不排斥基于源代 码的再分发，CentOS 就是将商业的 Linux 操 作系统 RHEL 进行源代码再编译后分发，并 在 RHEL 的基础上修正了不少已知的漏洞

**Ubuntu**：www.ubuntu.com

优秀易用的桌面环境，基于 Debian 构建。官方每年会发布两个版本，每个版本的版本号由两部分组成: 主版本号 + 副版本号，主版本号为当年年份，长期支持版的年份为偶数，测试版年份为奇数，副版本号为月份，在 4 月份发布的为相对稳定版， 在 10 月份发布的为测试版。

1.4 Linux内核**

Linux 系统从应用角度来看，分为内核空间和用户空间两个部分。

Linux 的内核主要由 5 个子系统组成：进程调度、内存管理、虚拟文件系统、网络接口、进程间通信。下面将依次讲解这 5 个子系统。

* **进程调度SCHED**：进程调度指的是系统对进程的多种状态之间转换的策略。Linux 下的进程调度有 3 种策略：SCHED_OTHER、SCHED_FIFO 和 SCHED_RR。

  * SCHED_OTHER：分时调度策略（默认），是用于针对普通进程的时间片轮转调度策略。
  * SCHED_FIFO：实时调度策略，是针对运行的实时性要求比较高、运行时间短的进程调度策略
  * SCHED_RR：实时调度策略，是针对实时性要求比较高、运行时间比较长的进程调度策略。

* **内存管理MMU**

  * 内存管理是多个进程间的内存共享策略。在 Linux 中，内存管理主要说的是虚拟内存。
  * 虚拟内存可以让进程拥有比实际物理内存更大的内存，可以是实际内存的很多倍。
  * 每个进程的虚拟内存有不同的地址空间，多个进程的虚拟内存不会冲突。

* **虚拟文件系统VFS**

  * 在 Linux 下支持多种文件系统，如 ext、ext2、minix、umsdos、msdos、vfat、ntfs、proc、smb、ncp、iso9660、sysv、hpfs、affs 等。
  * 目前 Linux 下最常用的文件格式是 ext2 和 ext3。

* **网络接口**：Linux 是在 Internet 飞速发展的时期成长起来的，所以 Linux 支持多种网络接口和协议。网络接口分为网络协议和驱动程序，网络协议是一种网络传输的通信标准，而网络驱动则是对硬件设备的驱动程序。Linux 支持的网络设备多种多样，几乎目前所有网络设备都有驱动程序。

* **进程间通信**：Linux 操作系统支持多进程，进程之间需要进行数据的交流才能完成控制、协同工作等功能，Linux 的进程间通信是从 UNIX 系统继承过来的。Linux 下的进程间的通信方式主要有**管道、信号、消息队列、共享内存和套接字**等方法。




#### 2. Linux目录

与 Windows 下的文件组织结构不同，Linux 不使用磁盘分区符号来访问文件系统，而是将**整个文件系统表示成树状的结构**，Linux 系统每增加一个文件系统都会将其加入到这个树中。

操作系统文件结构的开始，只有一个单独的顶级目录结构，叫做根目录。所有一切都**从“根”开始，用“/”代表**，并且延伸到子目录。Linux 则通过 **“挂接” 的方式把所有分区都放置在 “根” 下各个目录里**。一个 Linux 系统的文件结构如下图所示。

**2.1 Linux目录结构**

![](Linux_cpp_firsttry.assets/1563553243830.png)

在 linux 中根目录的子目录结构相对是固定的 (名字固定), 不同的目录功能是也是固定的

* bin: binary, 二进制文件目录，存储了可执行程序，今天要将的命令对应的可执行程序都在这个目录中

* sbin: super binary, root 用户使用的一些二进制可执行程序

* etc: 配置文件目录，系统的或者用户自己安装的应用程序的配置文件都存储在这个目录中

* lib: library, 存储了一些动态库和静态库，给系统或者安装的软件使用

* media: 挂载目录，挂载外部设备，比如：光驱，扫描仪

* mnt: 临时挂载目录，比如我们可以将 U 盘临时挂载到这个目录下

* proc: 内存使用的一个映射目录，给操作系统使用的

* tmp: 临时目录，存放临时数据，重启电脑数据就被自动删除了

* boot: 存储了开机相关的设置

* home: 存储了普通用户的家目录，家目录名和用户名相同

* root: root 用户的家目录

* dev: device , 设备目录，Linux 中一切皆文件，所有的硬件会抽象成文件存储起来，比如：键盘， 鼠标

* lost+found: 一般时候是空的，电脑异常关闭 / 崩溃时用来存储这些无家可归的文件，用于用户系统恢复

* opt: 第三方软件的安装目录

* var: 存储了系统使用的一些经常会发生变化的文件， 比如：日志文件

* usr: unix system resource, 系统的资源目录
  * /usr/bin: 可执行的二进制应用程序
  * /usr/games: 游戏目录
  * /usr/include: 包含的标准头文件目录
  * /usr/local: 和 opt 目录作用相同，安装第三方软件

对于用户自己的文件，一般都是存放到自己的家目录中，也就是 `/home/用户名`里边，通过指定的相应的路径就可以找到这个文件了。关于路径的指定的有两种方式：相对路径和绝对路径。

**2.2 相对路径**

相对路径就是相对于当前文件的路径

* `./`：也可用.表示
* `../`:当前目录的上一层，也可用..表示

**2.3 绝对路径**

* Linux：起始节点为根目录，比如： /root/luffy/get/onepiece
* Windows: 起始节点为某个磁盘的盘符，比如：f:\\\root\\\luffy\\\get\\\onepiece


#### 3.命令解析器

在 Linux 中需要通过终端执行对应的命令来完成某些操作，这些命令都是通过命令解析器解析完成并执行的

**3.1 工作原理**

命令解析器在Linux操作系统中就是一个进程，它的名字叫做`bash`，也就是`shell`（UNIX是shell，bash是Linux中的增强版sh）。

* 在Linux中有一个叫做`PATH`的环境变量，里面存储了一些系统目录

```
#通过echo命令可以查看环境变量PATH中的值
echo $PATH
```

* 命令解析器需要依次搜索`PATH`中的各个目录，检查这些目录中是否有用户输入的指令
  * 如果找到了，执行该目录下的可执行程序，用户输入的命令就被执行完毕了
  * 如果没有找到，继续搜索其他目录，最后还是没有找到，会提示命令找不到，因此无法被执行

**3.2 命令提示行**

在 Linux 终端中，输入要执行的指令之前会有想用的命令提示，我们将其称之为命令提示行

```
[root@VM-8-14-centos ~/luffy/get/onepiece]#
[robin@VM-8-14-centos ~/luffy/get/onepiece]$ 
```

* root : 当前登录的用户的用户名

* @: at -> 在
* VM-8-14-centos: 主机名，在安装这个 linux 操作系统的时候手动指定，可以修改
  * ~: 当前用户的家目录
    * 在 linux 中有很多用户，每个用户都用一个属于自己的目录，这个目录称之为家目录
    * 普通用户家目录 /home/用户名 , root 用户家目录 /root
  * ~/luffy/get/onepiece: 当前用户所在的工作目录，也可以使用 `pwd` 命令查看
  * #: 代表当前用户是 root 用户
  * $: 当前用户是普通用户，也就是说例子中的 robin 是一个普通用户

**3.3 命令行快捷键**

| 快捷键           | 功能                      | 备注                                                         |
| ---------------- | ------------------------- | ------------------------------------------------------------ |
| **Tab**          | 命令自动补齐              | 我们可以连续按两次Tab键，在当前终端中就可以显示出所有匹配成功的shell命令 |
| Ctrl+p           | 显示输入的上一个历史命令  | **↑**                                                        |
| Ctrl+n           | 显示输入的下一个历史命令  | **↓**                                                        |
| Ctrl+a           | 光标移动命命令行首        | **Home**                                                     |
| Ctrl+e           | 光标移动命命令行尾        | **End **                                                     |
| Ctrl+u           | 删除光标前的部分字符串    |                                                              |
| Ctrl+k           | 删除光标后的部分字符串    |                                                              |
| →                | 光标向右移动一个字符      |                                                              |
| ←                | 光标向右移动一个字符      |                                                              |
| Backspace/Delete | 删除光标前 / 后的一个字符 |                                                              |

### 二、常用命名

### 1.文件管理命令

https://subingwen.cn/linux/file-commands/#8-1-%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90

##### **cd命令**

* 进入指定目录
* 进入家目录 1. cd 2. cd `~`
  * 普通用户：/home/用户名
  * 管理员：/root
* 在临近的两个目录之间切换  cd -

##### **ls命令**

```
ls [args] 目录名/文件名
```

* 显示所有文件 `ls -a`
* 显示文件详细信息 `ls -l`

边的信息量还是非常大的，其中包括: **文件类型 , 文件所有者对文件的操作权限 , 文件所属组用户对文件的操作权限 , 其他人对文件的操作权限 , 硬链接计数 , 文件所有者 , 文件所属组 , 文件大小 , 文件的修改日期 , 文件名**

```
robin@OS:~$ ls -l
total 204
-rw-rw-r--  1 robin robin    268 Mar 22 17:32 a.c
drwxrwxr-x  2 robin robin   4096 Aug  4  2019 config
-rw-r--r--  1 robin robin 129487 Dec 25 11:28 english.txt
drwxrwxr-x  5 robin robin   4096 Jan 13 17:35 udp

# 文件详细信息介绍
 d      rwx       rwx     r-x     5    robin    robin    4096    Jan 13 17:35    udp
 |       |         |       |      |      |        |       |          |	          |
文件    文件所    文件所   其他人 硬链接  文件     文件   文件大小  文件修改时间     文件名
类型   有者权限  属组权限  权限   计数   所有者   所属组  
```

#

**文件类型**

在 Linux 操作系统中，一共有 7 中文件类型，这 7 中类型是根据文件属性进行划分的，而不是根据文件后缀划分的。

-: 普通的文件，在 Linux 终端中没有执行权限的为白色，压缩包为红色，可执行程序为绿色字体
d: 目录 (directory), 在 Linux 终端中为蓝色字体，如果目录的所有权限都是开放的，有绿色的背景色
l: 软链接文件 (link), 相当于 windows 中的快捷方式，在 Linux 终端中为淡蓝色 (青色) 字体
c: 字符设备 (char), 在 Linux 终端中为黄色字体
b: 块设备 (block), 在 Linux 终端中为黄色字体
p: 管道文件 (pipe), 在 Linux 终端中为棕黄色字体
s: 本地套接字文件 (socket), 在 Linux 终端中为粉色字体

**用户类型**

在 Linux 中有三大类用户: **文件所有者 , 文件所属组用户 , 其他人** , 我们可以对同一个文件给这三种人设置不同的操作权限，用于限制用户对文件的访问。

* 文件所有者：文件的主人
* 文件所属组：文件的主人属于哪个组，文件默认也就属于哪个组
* 其他人

**文件权限**

* 读权限 ,r 
* 写权限 , w
* 执行权限 ,x 
* 无权限,-

**硬链接计数**

硬链接计数是一个整数，如果这个数为 N (N>=1)，就说明在一个或者多个目录下一共有 N 个文件，但是这 N 个文件并不占用多块磁盘空间，他们使用的是同一块，如果通过其中一个文件修改了磁盘数据，那么其他文件中的内容也就变了。每当我们给给磁盘文件创建一个硬链接（使用 ln），磁盘上就会出现一个新的文件名，硬链接计数加 1，但是这新文件并不占用任何的磁盘空间，文件名还是映射到原来的磁盘地址上。。

硬链接和拷贝区别：

![image-20210125185650189](Linux_cpp_firsttry.assets/image-20210125185650189.png)

**其他属性**

* 文件大小->单位是字节
* 文件日期：修改日期
* 文件名：如果文件类型是软连接会这样显示： link -> /root/file/test, 后边的路径表示快捷方式链接的是哪个磁盘文件

除了ls -l外还有其他参数

`ls -lh`说人话，显示基于字节进行换算

`ls -lF`如果是目录，后面会加多一个/

#### 创建删除目录

##### **mkdir命令**

创建目录：1.单层目录：`mkdir 新目录名字`	2.多层目录：`mkdir parent/child/baby1 -p`

##### **rmdir/rm命令**

* rmdir: 只能删除空目录
* rm: 可删除文件，删除目录需要加-r，意思是递归（recursion）
  * -i：删除时给提示
  * -f：强制删除文件，直接删除且不能回复

##### **cp命令**

cp 就是 copy, 拷贝，使用这个命令可以拷贝文件也可以拷贝目录

* 拷贝文件 => 文件不存在得到新文件, 文件存在就覆盖。语法：cp 文件A 文件B，拷贝文件A到文件B
* 拷贝目录 ==> 目录不存在得到新目录, 该目录被拷贝到存在的目录中，拷贝目录需要-r。语法：cp 目录A 目录B -r

```
cp A/a.txt B	# 拷贝 A目录中的 a.txt 到目录B中
cp A/* B -r	# 拷贝 A目录中的所有文件到目录B中, 不能确定A目录中是否有子目录, 因此需要加 -r
```

##### **mv命令**

mv 就是 move, 这个 Linux 命令既能移动文件所在目录也可以给文件改名。

* 文件的移动。 mv A B, 其中A可以是文件也可以是目录, B必须是目录而且必须是存在的
* 文件改名。 mv A B，其中A可以是文件也可以是目录，并且是存在的, B原来是不存在的
* 文件覆盖。 mv A B， A文件中的内容覆盖B文件中的内容, A文件被删除, 只剩下B文件

#### 查看文件内容

##### **cat命令**

该命令可以将文件内容显示到终端，由于终端是有缓存的，因此能显示的字节数也是受限制的。 如果文件太大数据就不能完全显示出来了，因此该命令适合查看比较小的文件内容。

##### **more命令**

cat 要高级一点，我们可以以翻屏的方式查看文件中的内容。回车: 显示下一行，空格: 向下滚动一屏，b: 返回上一屏，q: 退出more

##### **less命令**

跟more差不多

##### **head命令**

文件头部若干行，head -行数 文件名

##### **tail命令**

#### 链接的创建

原理上，硬链接和源文件的inode节点号相同，两者互为硬链接。软连接和源文件的inode节点号不同，进而指向的block也不同，软连接block中存放了源文件的路径名。 实际上，**硬链接和源文件是同一份文件**，而**软连接是独立的文件，类似于快捷方式，存储着源文件的位置信息便于指向**。 使用限制上，不能对目录创建硬链接，不能对不同文件系统创建硬链接，不能对不存在的文件创建硬链接；可以对目录创建软连接，可以跨文件系统创建软连接，可以对不存在的文件创建软连接。

##### **ln命令**

* 软连接：绝对路径

```
# 语法: ln -s 源文件路径 软链接文件的名字(可以带路径)

# 查看目录文件
[root@VM-8-14-centos ~/luffy]# ll
total 8
drwxr-xr-x 3 root root 4096 Jan 25 17:27 get
-rw-r--r-- 1 root root   37 Jan 25 17:26 onepiece.txt

# 给 onepiece.txt 创建软连接, 放到子目录 get 中
[root@VM-8-14-centos ~/luffy]# ln -s /root/luffy/onepiece.txt get/link.lnk  
[root@VM-8-14-centos ~/luffy]# ll get
total 4
lrwxrwxrwx 1 root root   24 Jan 25 17:27 link.lnk -> /root/luffy/onepiece.txt
drwxr-xr-x 2 root root 4096 Jan 24 21:37 onepiece
```

* 硬链接：相对路径; 目录是不允许创建硬链接的。

```
# 语法: ln 源文件 硬链接文件的名字(可以带路径)

# 创建硬链接文件, 放到子目录中
[root@VM-8-14-centos ~/luffy]# ln onepiece.txt get/link.txt

# 查看链接文件和硬链接计数, 从 1 --> 2
[root@VM-8-14-centos ~/luffy]# ll get
total 8
lrwxrwxrwx 1 root root   24 Jan 25 17:27 link.lnk -> /root/luffy/onepiece.txt
-rw-r--r-- 2 root root   37 Jan 25 17:26 link.txt
drwxr-xr-x 2 root root 4096 Jan 24 21:37 onepiece
```

#### 文件属性

**修改文件文件权限**

##### **chmod命令**

文件权限是针对**文件所有者 , 文件所属组用户 , 其他人**这三类人而言的，对应的操作指令是 chmod。设置方式也有两种，分别为**文字设定法**和数字设定法。

* 文字设定法

```
#chmod
# 语法格式: chmod who [+|-|=] mod 文件名
	- who:
		- u: user  -> 文件所有者
		- g: group -> 文件所属组用户
		- o: other -> 其他
		- a: all, 以上是三类人 u+g+o
	- 对权限的操作:
		+: 添加权限
		-: 去除权限
		=: 权限的覆盖
	- mod: 权限
		r: read, 读
		w: write, 写
		x: execute, 执行
		-: 没有权限

# 将文件所有者权限设置为读和执行, 也就是权限覆盖
chmod u=rx b.txt 
# 给其他人添加写和执行权限
robin@OS:~/Linux$ chmod o+wx b.txt 
# 给文件所属组用户去掉读和执行权限
robin@OS:~/Linux$ chmod g-rx b.txt 
# 将文件所有者,文件所属组用户,其他人权限设置为读+写+执行
robin@OS:~/Linux$ chmod a=rwx b.txt
```

* 数字设定法

```
# 语法格式: chmod [+|-|=] mod 文件名
	- 对权限的操作:
		+: 添加权限
		-: 去除权限
		=: 权限的覆盖, 等号可以不写
	- mod: 权限描述, 所有权限都放开是 7
		- 4: read, r
		- 2: write, w
		- 1: execute , x
		- 0: 没有权限

# 分解: chmod 0567 a.txt

    0           5           6             7
  八进制     文件所有者  文件所属组用户    其他人
              r + x       r + w         r+w+x


# 文件所有者去掉执行权限, 所属组用户去掉写权限, 其他人去掉读+写权限
robin@OS:~/Linux$ chmod -123 c.txt
# 文件所有者添加执行权限, 所属组用户和其他人权限不变
robin@OS:~/Linux$ chmod +100 c.txt
# 将文件所有者,文件所属组用户,其他人权限设置为读+写, 没有执行权限
robin@OS:~/Linux$ chmod 666 c.txt
```

**修改文件所有者**

##### **chown命令**

默认情况下，文件是通过哪个用户创建出来的，就属于哪个用户，这个用户属于哪个组，文件就属于哪个组。如果有特殊需求，可以修改文件所有者，对应的操作命令是 chown。因为修改文件所有者就跨用户操作，普通用户没有这个权限，需要借助管理员权限才能完成该操作。

普通用户借助管理员权限执行某些shell命令, 需要在命令前加关键字sudo, 但是普通用户默认是没有使用 sudo的资格的, 需要修改 `/etc/sudoers` 文件

https://subingwen.cn/linux/sudoers/

```
# 语法1-只修改所有者: 
$ sudo chown 新的所有者 文件名

# 语法2-同时修改所有者和所属组: 
$ sudo chown 新的所有者:新的组名 文件名

# 将 b.txt 的所有者修改为 luffy
robin@OS:~/Linux$ sudo chown luffy b.txt
[sudo] password for robin: 
robin@OS:~/Linux$ ll b.txt 
-rw-rw-rw- 2 luffy robin 2929 Apr 14 18:53 b.txt

# 同时修改文件所有者和文件所属组
robin@OS:~/Linux$ sudo chown robin:luffy b.txt 
robin@OS:~/Linux$ ll b.txt 
-rw-rw-rw- 2 robin luffy 2929 Apr 14 18:53 b.txt
```

**修改文件所属组**

##### **chgrp命令**

`sudo chgrp 新的组 文件名`

#### 其他命令

##### **tree命令**

```
# 语法格式
$ tree [-L n]         # 查看当前目录的结构, n为显示的目录层数
$ tree 目录名  [-L n]	# 查看指定目录的结构, n为显示的目录层数

# tree -L 1
```

##### **pwd命令**

pwd 命令用户当前所在的工作目录，没有参数，直接执行该命令即可。

##### **touch命令**

使用 touch 命令可以创建一个新的空文件 , 如果指定的文件是已存在的，只会更新文件的修改日期，对内容没有任何影响。

`touch 文件名`

##### **which命令**

which 命令可以查看要执行的命令所在的实际路径，命令解析器工作的时候也会搜索这个目录。需要注意的是该命令只能查看非内建的shell指令所在的实际路径, 有些命令是直接写到内核中的, 无法查看。

我们使用的大部分 shell 命令都是放在系统的 **/bin 或者 /usr/bin** 目录下:

##### **重定向命令**

关于重定向使用最多的是就是输出重定向 , 顾名思义就是修改输出的数据的位置，通过重定向操作我们可以非常方便的进行文件的复制，或者文件内容的追加。输出重定向使用的不是某个关键字而是符号 **> 或者 >>**。

* \>: 将文件内容写入到指定文件中，如果文件中已有数据，则会使用新数据覆盖原数据
* \>>:将输出的内容追加到指定的文件尾部

`date >> test.txt`

